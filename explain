SELECT
explain.fiu_id as fiu_id, 
fu.fulfill_item_unit_destination_pincode as dest_pincode,
explain.warehouse as warehouse,
explain.inv_type as inv_type, 
explain.lpe_tier as lpe_tier,
explain.effective_inventory as effective_inventory,
explain.accepted as accepted,
explain.breaching as breaching,
explain.reason as reason,
explain.lpd as logistics_promise_date,
explain.sla as sla,
explain.cost as cost,
fu.product_id_key as product_key,
fu.fulfill_item_service_profile as service_profile,
d.full_date as reserve_date,
d.week_num_in_year as reserve_week,
d.month as reserve_num_month,
d.month_name as reserve_month,
p.product_id as product_id,
p.analytic_vertical as vertical,
p.analytic_business_unit as bu,
p.analytic_super_category as super_category,
p.analytic_category as category,
fu.fulfill_item_unit_status_modified as unit_status

FROM bigfoot_external_neo.scp_fulfillment__explain_fulfill_hive_fact as explain
LEFT JOIN bigfoot_external_neo.scp_fulfillment__fulfillment_unit_hive_fact as fu
ON fu.fulfill_item_unit_id = explain.fiu_id
LEFT JOIN bigfoot_external_neo.sp_product__product_categorization_hive_dim as p
ON fu.product_id_key = p.product_categorization_hive_dim_key
LEFT JOIN bigfoot_external_neo.sp_seller__seller_hive_dim as seller
ON seller.seller_hive_dim_key = fu.seller_id_key
LEFT JOIN bigfoot_external_neo.scp_oms__date_dim_fact as d
on fu.fulfill_item_unit_reserve_actual_date_key = d.date_dim_key

WHERE fulfill_item_unit_status_modified not in ('warehouse_cancellation_requested','customer_cancelled','procurement_cancellation_requested','seller_cancelled')
and d.date_dim_key = 20170325
and seller.is_first_party_seller=1

GROUP BY
explain.fiu_id,
fu.fulfill_item_unit_destination_pincode,
explain.warehouse,
explain.inv_type,
explain.lpe_tier,
explain.effective_inventory,
explain.accepted,
explain.breaching,
explain.reason,
explain.lpd,
explain.sla,
explain.cost,
fu.product_id_key,
fu.fulfill_item_service_profile,
d.full_date,
d.week_num_in_year,
d.month,
d.month_name,
p.product_id,
p.analytic_vertical,
p.analytic_business_unit,
p.analytic_super_category,
p.analytic_category,
fu.fulfill_item_unit_status_modified
